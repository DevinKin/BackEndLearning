# Elasticsearch介绍

## 数据输入：文档和索引

Elasticsearch是一个分布式文档存储框架，Elasticsearch存储已序列化为JSON文档的复杂数据结构。

当集群中有多个Elasticsearch节点时，存储的文档将分布在集群中，并且可以从任何节点立即访问。

Elasticsearch使用称为倒排索引的数据结构，该结构支持非常快速的全文本搜索。

索引可以认为是文档的优化集合，每个文档都是字段的集合，这些字段是包含您的数据的键值对。

Elasticsearch还具有无模式的能力，这意味着可以为文档建立索引，而无需明确指定如何处理文档中可能出现的每个不同字段。

可以定义规则来控制动态映射，也可以显式定义映射以完全控制字段的存储和索引方式，进一步控制数据的使用方式。

定义自己的映射能够：

- 区分全文字符串字段和精确值字符串字段
- 执行特定于语言的文本分析
- 优化字段以进行部分匹配
- 使用自定义日期格式
- 使用无法自动检测到的数据类型，例如geo_point和geo_shape

## 信息输出：搜索和分析

Elasticsearch提供了一个简单，一致的REST API，用于管理您的集群以及建立索引和搜索数据。

### 查询数据

Elasticsearch REST API支持结构化查询，全文查询和结合了两者的复杂查询。

- 结构化查询：结构化查询类似于您可以在SQL中构造的查询类型。
- 全文查询：查找与查询字符串匹配的所有文档，并按相关性排序返回它们（它们与您的搜索字词的匹配程度如何）。

Elasticsearch在支持高性能地理和数字查询的优化数据结构中索引非文本数据。

Elasticsearch查询方式：

- Query DSL：使用Elasticsearch全面的JSON样式的查询语言（Query DSL）访问所有这些搜索功能。

- SQL：构造SQL风格的查询以在Elasticsearch内部本地搜索和聚合数据

### 分析数据

Elasticsearch聚合使您能够构建数据的复杂摘要，并深入了解关键指标，模式和趋势。

聚合操作与搜索操作请求可以一起运行。

## 可伸缩性和弹性：集群，节点和分片

Elasticsearch知道如何平衡多节点集群以提供规模和高可用性。

Elasticsearch索引实际上只是一个或多个物理碎片的逻辑分组，其中每个分片实际上是一个独立的索引。

分片有两种类型：

- 主分片
- 副本分片

索引中的每个文档都属于一个主分片。副本分片是主分片的副本。副本可提供数据的冗余副本，以防止硬件故障并提高处理读取请求（如搜索或检索文档）的能力。

创建索引时，索引中主分片的数量是固定的，但是副本分片的数量可以随时更改，而不会中断索引或查询操作。

## 容灾处理

Elasticsearch提供了 Cross-cluster replication (CCR，跨集群复制)机制，可以自动将索引从主群集同步到可以用作热备份的辅助远程群集。

跨集群复制是主动-被动的。主群集上的索引是活动的领导者索引，并处理所有写请求。复制到辅助群集的索引是只读随从者。